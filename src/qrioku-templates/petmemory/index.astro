---
import TextBlock from "../../components/TextBlock.astro";
import ImageBlock from "../../components/ImageBlock.astro";
import LinkBlock from "../../components/LinkBlock.astro";

// Props passed from [slug].astro
const { metadata, structure, content } = Astro.props;
---

<div
    class="min-h-screen bg-gradient-to-br from-pink-50 to-purple-50 py-12 px-4 sm:px-6 lg:px-8"
>
    <div
        class="max-w-3xl mx-auto bg-white/80 backdrop-blur-lg rounded-3xl shadow-2xl overflow-hidden border border-white/40"
    >
        {/* Header */}
        <div class="text-center pt-12 pb-8 px-8">
            <h1
                class="text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 mb-2 animate-fade-in-down"
            >
                {metadata.name}
            </h1>
            <p
                class="text-gray-500 font-medium tracking-wide uppercase text-sm"
            >
                {new Date(metadata.starts_at).toLocaleDateString()} - {
                    new Date(metadata.expires_at).toLocaleDateString()
                }
            </p>
            <p
                class="text-purple-600 text-lg mt-2 animate-fade-in-down delay-200"
            >
                üåà A beautiful memory full of love and joy üåü
            </p>
        </div>

        {/* Dynamic Content Rendering */}
        <div class="px-8 pb-12 space-y-8">
            {
                structure.map((block: any, idx: any) => {
                    const type = block.type;
                    const ref = block.ref;

                    if (type === "text") {
                        const data = content.texts[ref];
                        return (
                            <TextBlock
                                key={idx}
                                value={data.value}
                                style={data.style}
                                class="text-gray-800 text-lg leading-relaxed animate-slide-up delay-[${idx*100}ms]"
                            />
                        );
                    }

                    if (type === "image") {
                        const data = content.images[ref];
                        return (
                            <ImageBlock
                                key={idx}
                                url={data.url}
                                alt={data.alt}
                                class="rounded-2xl shadow-lg hover:scale-105 transition-transform duration-500 animate-fade-in"
                            />
                        );
                    }

                    if (type === "link") {
                        const data = content.links[ref];
                        return (
                            <LinkBlock
                                key={idx}
                                label={data.label}
                                url={data.url}
                                class="inline-block px-5 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold rounded-full shadow-md hover:scale-105 transition-transform duration-300 animate-bounce"
                            />
                        );
                    }

                    return null;
                })
            }
        </div>

        {/* Footer */}
        <div class="bg-gray-50 px-8 py-6 text-center text-xs text-gray-400">
            Made with ‚ù§Ô∏è using Qrioku
        </div>
    </div>
</div>

<style>
    /* Animations */
    .animate-fade-in-down {
        animation: fadeInDown 1s ease-out forwards;
    }

    .animate-slide-up {
        animation: slideUp 0.8s ease-out forwards;
    }

    .animate-fade-in {
        animation: fadeIn 1.2s ease-out forwards;
    }

    @keyframes fadeInDown {
        0% {
            opacity: 0;
            transform: translateY(-20px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes slideUp {
        0% {
            opacity: 0;
            transform: translateY(20px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes fadeIn {
        0% {
            opacity: 0;
        }
        100% {
            opacity: 1;
        }
    }
</style>
