---
const { metadata, content } = Astro.props;

/* =========================
   CONTENT-DRIVEN TEMPLATE
========================= */

// HERO → primera imagen con URL
const images = Object.values(content.images || {}).filter(
  (img: any) => img?.url
);

const heroImage = images[0] as any;
const galleryImages = images.slice(1);

// TEXTOS → todos debajo del hero
const texts = Object.values(content.texts || {}).filter(
  (text: any) => text?.value
);

// LINKS → al final
const links = Object.values(content.links || {}).filter(
  (link: any) => link?.url
);
---

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>{metadata.name} · Memoria</title>
    <meta name="description" content="Memoria conmemorativa" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Inter:wght@300;400;500&display=swap"
      rel="stylesheet"
    />

    <!-- Icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
  </head>

  <body
    class="min-h-screen bg-[radial-gradient(circle_at_top,theme(colors.slate.900),theme(colors.slate.950))] text-slate-100 font-sans leading-relaxed"
  >
    <main class="mx-auto max-w-4xl px-6 py-16">

      <!-- HERO -->
      {heroImage && (
        <section class="relative mb-28 overflow-hidden rounded-3xl">
          <div class="relative h-[520px] w-full">
            <img
              src={heroImage?.url as any}
              alt={heroImage?.alt as any}
              class="absolute inset-0 h-full w-full object-cover brightness-75 grayscale-[15%]"
            />

            <!-- Overlay -->
            <div class="absolute inset-0 bg-gradient-to-t from-slate-950/80 via-slate-950/40 to-transparent"></div>

            <!-- Content -->
            <div class="relative z-10 flex h-full flex-col items-center justify-end px-6 pb-14 text-center">
              <i class="fa-solid fa-dove mb-5 text-amber-400 text-4xl"></i>

              <h1 class="font-serif text-[clamp(2.4rem,4vw,3.4rem)] font-semibold tracking-tight">
                {metadata.name}
              </h1>

              <p class="mt-4 max-w-xl text-slate-300 text-base">
                Un espacio de recuerdo, gratitud y memoria eterna.
              </p>
            </div>
          </div>
        </section>
      )}

      <!-- TEXTS -->
      {texts.map((text: any) => (
        <div class="my-10 text-[1.05rem]">
          {text.value}
        </div>
      ))}

      <!-- IMAGES GRID -->
      {galleryImages.length > 0 && (
        <div class="my-16 grid grid-cols-[repeat(auto-fit,minmax(240px,1fr))] gap-5">
          {galleryImages.map((img: any) => (
            <img
              src={img.url}
              alt={img.alt}
              class="h-full w-full rounded-xl object-cover brightness-90 grayscale-[10%]"
            />
          ))}
        </div>
      )}

      <!-- LINKS -->
      {links.length > 0 && (
        <div class="my-20 flex flex-wrap justify-center gap-4">
          {links.map((link: any) => (
            <a
              href={link.url}
              target="_blank"
              class="inline-flex items-center gap-2 rounded-full border border-white/15 px-6 py-3 backdrop-blur transition hover:border-amber-400 hover:text-amber-400"
            >
              <i class="fa-solid fa-candle-holder" />
              {link.label}
            </a>
          ))}
        </div>
      )}

      <!-- FOOTER -->
      <footer class="mt-24 text-center text-sm text-slate-400">
        <i class="fa-regular fa-heart"></i>
        <span class="ml-2">
          En memoria eterna · {new Date(metadata.starts_at).getFullYear()}
        </span>
      </footer>

    </main>
  </body>
</html>
